<!doctype html>
<html lang="da">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Bøder total</title>

<style>
  *{box-sizing:border-box}
  html,body{
    margin:0;padding:0;height:100%;
    background:transparent;
    font-family:Inter,Arial,sans-serif;
    display:flex;align-items:center;justify-content:center;
  }
  .wrap{width:100%;padding:12px;display:flex;justify-content:center}
  .card{
    width:100%;
    max-width:520px;
    border-radius:18px;
    padding:18px;
    text-align:center;
    border:1px solid #e5e7eb;
    background:radial-gradient(900px 420px at top,#ffffff,#f8fafc);
    box-shadow:0 8px 20px rgba(0,0,0,.08);
  }
  .label{
    letter-spacing:.18em;
    text-transform:uppercase;
    font-size:12px;
    color:#6b7280;
    margin-bottom:8px;
    font-weight:900;
  }
  .amount{
    font-size:44px;
    font-weight:900;
    line-height:1;
    color:#991b1b;
  }
  .unit{margin-top:6px;font-size:14px;font-weight:900;color:#9ca3af}
  .sub{margin-top:10px;font-size:12px;color:#6b7280}
  .err{margin-top:10px;font-size:12px;color:#b91c1c}
  pre{
    text-align:left;
    margin:10px 0 0;
    padding:10px;
    border-radius:12px;
    background:#0b0f14;
    color:#e5e7eb;
    font-size:11px;
    overflow:auto;
    max-height:180px;
  }
</style>
</head>

<body>
<div class="wrap">
  <div class="card">
    <div class="label">Bøder total</div>
    <div id="amount" class="amount">0</div>
    <div class="unit">DKK</div>
    <div id="sub" class="sub">Debug aktiv (skal vise API-svar)</div>
    <div id="err" class="err"></div>
    <pre id="debug">Indlæser…</pre>
  </div>
</div>

<script>
  const API_URL =
    "https://script.google.com/macros/s/AKfycbw7RzHmSwFOyN-JmLNR7qlt-prbVoOe5dEKkvOlus2LzZH2s7eJtwWceeIzysesubTj/exec";

  const fmt = n => Number(n || 0).toLocaleString("da-DK");
  const setErr = msg => document.getElementById("err").innerText = msg || "";

  function animate(el, target){
    let current = 0;
    const dir = target >= 0 ? 1 : -1;
    const steps = 70;
    const step = Math.max(1, Math.floor(Math.abs(target) / steps));

    const timer = setInterval(() => {
      current += step * dir;
      if ((dir === 1 && current >= target) || (dir === -1 && current <= target)) {
        current = target;
        clearInterval(timer);
      }
      el.innerText = fmt(current);
    }, 20);
  }

  fetch(API_URL + "?_=" + Date.now(), { cache: "no-store" })
    .then(r => r.text())
    .then(t => {
      document.getElementById("debug").innerText = t;

      let d;
      try { d = JSON.parse(t); }
      catch(e){
        setErr("Svar er ikke JSON (tjek debug-boksen).");
        return;
      }

      if (!d || !("boderTotal" in d)) {
        setErr("API svarer uden 'boderTotal' (tjek debug-boksen).");
        return;
      }

      const val = Number(d.boderTotal);
      if (!Number.isFinite(val)) {
        setErr("boderTotal er ikke et tal: " + String(d.boderTotal));
        return;
      }

      setErr("");
      animate(document.getElementById("amount"), val);
    })
    .catch(e => {
      setErr("Fetch fejl: " + (e && e.message ? e.message : String(e)));
      document.getElementById("debug").innerText = "(ingen svar)";
    });
</script>
</body>
</html>
