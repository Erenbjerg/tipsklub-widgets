<!doctype html>
<html lang="da">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Ã…rets total</title>

<style>
  *{box-sizing:border-box}

  /* Gennemsigtig iframe-baggrund + centrering */
  html,body{
    margin:0;
    padding:0;
    height:100%;
    background:transparent;   /* ðŸ‘ˆ VIGTIGSTE LINJE */
    font-family:Inter,Arial,sans-serif;
    color:#f9fafb;

    display:flex;
    align-items:center;
    justify-content:center;
  }

  .wrap{
    width:100%;
    padding:16px;
    display:flex;
    align-items:center;
    justify-content:center;
  }

  .card{
    background:radial-gradient(900px 400px at top,#1f2937,#020617);
    border:1px solid #1f2937;
    border-radius:22px;
    padding:22px;
    text-align:center;
    box-shadow:0 30px 60px rgba(0,0,0,.65);
    max-width:520px;
    width:100%;
  }

  .label{
    letter-spacing:.3em;
    text-transform:uppercase;
    font-size:12px;
    color:#fbbf24;
    margin-bottom:8px;
  }

  .amount{font-size:46px;font-weight:900;line-height:1}
  .amount.positive{color:#22c55e;text-shadow:0 0 18px rgba(34,197,94,.4)}
  .amount.negative{color:#ef4444;text-shadow:0 0 18px rgba(239,68,68,.45)}
  .currency{margin-top:4px;font-size:16px;font-weight:800;color:#9ca3af}
  .err{margin-top:10px;font-size:12px;color:#fca5a5}
</style>
</head>

<body>
<div class="wrap">
  <div class="card">
    <div class="label">Ã…rets total</div>
    <div id="amount" class="amount">0</div>
    <div class="currency">DKK</div>
    <div id="err" class="err"></div>
  </div>
</div>

<script>
  const API_URL =
    "https://script.google.com/macros/s/AKfycbwPiEOeSOq9kUmm8-B9RaOlVJPzg9u3xaDScxOD-f2q4aFg_lFLAzC6N5Mv2Gs4gDOR/exec";

  function setErr(msg){ document.getElementById("err").innerText = msg || ""; }

  function animate(el, target){
    let current = 0;
    const dir = target >= 0 ? 1 : -1;
    const steps = 70;
    const step = Math.max(1, Math.floor(Math.abs(target) / steps));

    const timer = setInterval(() => {
      current += step * dir;
      if ((dir === 1 && current >= target) ||
          (dir === -1 && current <= target)) {
        current = target;
        clearInterval(timer);
      }
      el.innerText = current.toLocaleString("da-DK");
    }, 20);
  }

  fetch(API_URL + "?_=" + Date.now(), { cache: "no-store" })
    .then(r => r.json())
    .then(data => {
      if (!data || !("total" in data)) {
        setErr("API svarer uden 'total'.");
        return;
      }

      const total = Number(data.total);
      if (!Number.isFinite(total)) {
        setErr("Kunne ikke lÃ¦se total: " + String(data.total));
        return;
      }

      const el = document.getElementById("amount");
      el.classList.remove("positive","negative");
      el.classList.add(total >= 0 ? "positive" : "negative");

      setErr("");
      animate(el, total);
    })
    .catch(e => {
      setErr("Fetch fejl: " + (e && e.message ? e.message : String(e)));
    });
</script>
</body>
</html>
